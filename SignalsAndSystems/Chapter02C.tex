\section{连续系统的冲激响应和阶跃响应}
零输入响应总是容易求解的，这是一个齐次方程，依\xref{tab:微分方程不同特征根对应的通解}求出通解后依初值定出系数即可
\begin{Equation}
    \Sum[i=0][n]a_iy_\te{zi}^{(i)}(t)=0\qquad
        y_\te{zi}^{(i)}(\zm)=y_\te{zi}^{(i)}(\zp)
\end{Equation}

零状态响应的求解就会有些麻烦，这是一个包含激励$f(t)$的非齐次方程，而非齐次方程我们只能对$f(t)$具有\xref{tab:微分方程不同激励所对应的特解}所列的特定形式进行求解，具有局限性，且过程较为复杂，需要先求相应齐次方程的通解，再写出一个非齐次方程的特解，最后还需要依据通过\xref{subsec:关于初值的一个重要讨论}中提到的积分法或待定系数法从$y_\te{zs}^{(i)}(\zm)=0$求出$y_\te{zs}^{(i)}(\zp)$的值，作为初值条件定出通解中的系数
\begin{Equation}
    \Sum[i=0][n]a_iy_\te{zs}^{(i)}(t)=f(t)\qquad
        y_\te{zs}^{(i)}(\zm)=0
\end{Equation}

因此，现在面临的问题就是，我们能否找到一种更简单的求解零状态响应的方法？而令人喜悦的是，这种方法确实存在！事实是，关于零状态响应，我们只需要讨论系统在冲激函数激励下的响应就够了，即冲激响应。而激励为任意函数$f(t)$的零状态响应均可以化归为冲激响应。

在本节，我们先来讨论如何计算冲激响应，在下一节再讨论激励为任意函数的情况。

\subsection{冲激响应}
\begin{BoxDefinition}[冲激响应]
    \uwave{冲激响应}（Impulse Response）是指激励为冲激函数$\dirac(t)$
    时的零状态响应
    \begin{Equation}
        h(t)=T[\qty{0},\dirac(t)]
    \end{Equation}
    即冲激响应是以下微分方程的解
    \begin{Equation}
        \Sum[i=0][n]a_ih^{(i)}(t)=\dirac(t)\qquad
        h^{(i)}(\zm)=0
    \end{Equation}
\end{BoxDefinition}

现在的问题是，我们如何务实的求出冲激响应
\begin{BoxFormula}[冲激响应]
    冲激响应$h(t)$可以表达为以下形式
    \begin{Equation}
        h(t)=h_0(t)\varepsilon(t)
    \end{Equation}
    其中$h_0(t)$满足以下微分方程
    \begin{Equation}
        \Sum[i=0][n]a_ih_0^{(i)}(t)=0\qquad t>0
    \end{Equation}
    其初值条件为
    \begin{Equation}
        h_0^{(n-1)}(\zp)=\frac{1}{a_n}\qquad
        h_0^{(i)}(\zp)=0\quad i=1,2,\cdots,n-2
    \end{Equation}
\end{BoxFormula}

\begin{Proof}
    根据\fancyref{def:冲激响应}
    \begin{Equation}&[1]
        \Sum[i=0][n]a_ih^{(i)}(t)=\dirac(t)
    \end{Equation}
    因此，$h^{(n)}(t)$包含$\dirac(t)$，$h^{(n-1)}(t)$包含$\varepsilon(t)$，$h^{(n-2)}(t)$及更低阶的导数均连续。

    运用\fancyref{exp:积分法}的思想，就\xrefpeq{1}两端作$[\zm,\zp]$的积分
    \begin{Equation}
        \Int[\zm][\zp]a_nh^{(n)}(t)\dd{t}=\Int[\zm][\zp]\dirac(t)\dd{t}
    \end{Equation}
    容易得到
    \begin{Equation}
        a_n[h^{(n-1)}(\zp)-h^{(n-1)}(\zm)]=1
    \end{Equation}
    而我们已知$h^{(i)}(\zm)=0, i=1,2,\cdots,n-1$
    \begin{Equation}
        h^{(n-1)}(\zp)=\frac{1}{a_n}
    \end{Equation}
    而由于比$n-1$更低阶的导数连续，因此
    \begin{Equation}
        h^{(i)}(\zp)=0\qquad i=1,2,\cdots,n-2
    \end{Equation}
    现在我们就求得了$h(t)$在$0^{+}$的初值条件了，那如何进一步解出$h(t)$呢？由于$h(t)$是零状态响应，而冲激出现在$t=0$处，因此$h(t)$必然可以表达为$h(t)=h_0(t)\varepsilon(t)$，而$h_0(t)$适用
    \begin{Equation}
        \Sum[i=0][n]a_ih_0^{(i)}(t)=0\qquad t>0
    \end{Equation}
    这是因为当$t>0$时有$h(t)=h_0(t)$且$\dirac(t)=0$，同时，$h_0(t)$的初值条件与$h(t)$也一致
    \begin{Equation}
        h_0^{(n-1)}(\zp)=\frac{1}{a_n}\qquad
        h_0^{(i)}(\zp)=0\quad i=1,2,\cdots,n-2
    \end{Equation}
    至此，我们就将冲激响应的求解，转化为了一个具有特定初值条件的齐次方程的求解。
\end{Proof}

\subsection{阶跃响应}
\begin{BoxDefinition}[阶跃响应]
    阶跃响应（Step Response）是指激励为阶跃函数$\varepsilon(t)$时的零状态响应
    \begin{Equation}
        g(t)=T\qty[{0},\varepsilon(t)]
    \end{Equation}
    即阶跃响应是以下微分方程的解
    \begin{Equation}
        \Sum[i=0][n]a_ig^{(i)}(t)=\varepsilon(t)\qquad
        g^{(i)}(\zm)=0
    \end{Equation}
\end{BoxDefinition}

阶跃响应的求解并不需要新的方法，通过\fancyref{fml:阶跃函数的导数}，我们知道$\varepsilon(t)$可以视为$\dirac(t)$的积分，而依据\fancyref{ppt:LTI系统的积分特性}，某个函数积分的零状态响应当等于该函数零状态响应的积分。而在这里，$\dirac(t)$的零状态响应是$h(t)$，$\dirac(t)$的积分$\varepsilon(t)$的零状态响应$g(t)$就也是$h(t)$的积分。故计算阶跃响应$g(t)$只需将冲激响应$h(t)$积分即可。

\begin{BoxFormula}[阶跃响应]
    阶跃响应$g(t)$可以表示为冲激响应$h(t)$的积分
    \begin{Equation}
        g(t)=\Int[-\infty][t]h(\tau)\dd{\tau}
    \end{Equation}
\end{BoxFormula}

\subsection{二阶系统的冲激响应和激励响应}
二阶系统是经常遇到的一类典型LTI系统，其微分方程为
\begin{Equation}[二阶系统的微分方程]
    y''(t)+2\alpha y'(t)+\omega_0^2y(t)=\omega_0^2f(t)
\end{Equation}
二阶系统的冲激响应和即阶跃响应，如\xref{tab:二阶系统的冲激响应和激励响应}所示
\begin{Tablex}[二阶系统的冲激响应和激励响应]{Xll}
<类型&冲激响应$h(t)$&阶跃响应$g(t)$\\>
过阻尼$\alpha>\omega_0$&
\xgp[3ex]{$\mal{h(t)=\frac{\omega_0^2}{\beta}\e^{-\alpha t}\sinh(\beta t)\varepsilon(t)}$}&
\xgp[3ex]{$\mal{g(t)=\frac{\omega_0^2}{\beta}\qty[\frac{\beta-\e^{-\alpha t}[\beta\cosh(\beta t)+\alpha\sinh(\beta t)]}{\alpha^2-\beta^2}]\varepsilon(t)}$}\\
\mc{3}(c){\xgp[0ex][3ex]{$\beta=\sqrt{\alpha^2-\omega_0^2}$}}\\ \hlinelig
欠阻尼$\alpha<\omega_0$&
\xgp[4ex]{$\mal{h(t)=\frac{\omega_0^2}{\beta}\e^{-\alpha t}\sin(\beta t)\varepsilon(t)}$}&
\xgp[4ex]{$\mal{g(t)=\frac{\omega_0^2}{\beta}\qty[\frac{\beta-\e^{-\alpha t}[\beta\cos(\beta t)+\alpha\sin(\beta t)]}{\alpha^2+\beta^2}]\varepsilon(t)}$}\\
\mc{3}(c){\xgp[0ex][3ex]{$\beta=\sqrt{\omega_0^2-\alpha^2}$}}\\ \hlinelig
临界阻尼$\alpha=\omega_0$&
\xgp[4ex]{$\mal{h(t)=\omega_0^2\e^{-\alpha t}t\varepsilon(t)}$}&
\xgp[4ex]{$\mal{g(t)=\qty[{1-\e^{-\alpha t}(1+\alpha t)}]\varepsilon(t)}$}\\
\end{Tablex}

现在我们来证明\xref{tab:二阶系统的冲激响应和激励响应}给出的结论。

\begin{Proof}[\xref{tab:二阶系统的冲激响应和激励响应}]
    根据\xrefeq{二阶系统的微分方程}，二阶系统适用以下微分方程
    \begin{Equation}&[1]
        y''(t)+2\alpha y'(t)+\omega_0^2y(t)=\omega_0^2f(t)
    \end{Equation}
    根据\fancyref{fml:冲激响应}，若要求冲激响应$h(t)$，先解$h_0(t)$
    \begin{Equation}&[2]
        h_0''(t)+2\alpha h_0'(t)+\omega_0^2h_0(t)=0
    \end{Equation}
    初值条件
    \begin{Equation}&[3]
        h_0'(\zp)=1\qquad h_0(\zp)=0
    \end{Equation}
    这里$h(t)$与$h_0(t)$的关系是
    \begin{Equation}&[4]
        h(t)=\omega_0^2h_0(t)\varepsilon(t)
    \end{Equation}
    这里多了一个$\omega_0^2$的缘故是\xrefpeq{1}右端的非齐次项是$\omega_0^2f(t)$而不是$f(t)$。\goodbreak

    \xrefpeq{2}对应的特征方程为
    \begin{Equation}&[4]
        \lambda^2+2\alpha\lambda+\omega_0^2=0
    \end{Equation}
    解得
    \begin{Equation}&[5]
        \lambda=\frac{-2\alpha\pm\sqrt{4\alpha^2-4\omega_0^2}}{2}=-\alpha\pm\sqrt{\alpha^2-\omega_0^2}
    \end{Equation}
    接下来，我们将根据特征方程根的情况，对$h_0(t)$的解的形式进行讨论。

    \paragraph{过阻尼情形}
    若$\alpha>\omega_0$，此时$\Delta>0$，具有两个不等的实根，记$\beta=\sqrt{\alpha^2-\omega_0^2}$则有
    \begin{Equation}&[6]
        \lambda=-\alpha\pm\beta
    \end{Equation}
    依据\xref{tab:微分方程不同特征根对应的通解}，此时的通解为
    \begin{Equation}&[7]
        h_0(t)=C_1\e^{-(\alpha-\beta)t}+C_2\e^{-(\alpha+\beta)t}
    \end{Equation}
    由$h_0(\zp)=0$容易得到
    \begin{Equation}&[8]
        C_1+C_2=0
    \end{Equation}
    由$h_0'(\zp)=1$容易得到
    \begin{Equation}&[9]
        -(\alpha-\beta)C_1-(\alpha+\beta)C_2=1
    \end{Equation}
    将\xrefpeq{8}改写为$C_2=-C_1$代入\xrefpeq{9}
    \begin{Equation}&[10]
        -(\alpha-\beta)C_1+(\alpha+\beta)C_1=1
    \end{Equation}
    即
    \begin{Equation}&[11]
        2\beta C_1=1\qquad C_1=\frac{1}{2\beta}\qquad C_2=-\frac{1}{2\beta}
    \end{Equation} 
    将\xrefpeq{11}代入\xrefpeq{7}
    \begin{Equation}&[12]
        h_0(t)=\frac{1}{2\beta}\qty[\e^{-(\alpha-\beta)t}-\e^{-(\alpha+\beta)t}]
    \end{Equation}
    或者
    \begin{Equation}&[13]
        h_0(t)=\frac{1}{2\beta}\qty[\e^{-\alpha t}\qty(\e^{\beta t}-\e^{-\beta t})]
    \end{Equation}
    改用双曲正弦的表示
    \begin{Equation}&[14]
        h_0(t)=\frac{1}{\beta}\qty[\e^{-\alpha t}\sinh\beta t]
    \end{Equation}
    将\xrefpeq{14}代入\xrefpeq{4}
    \begin{Equation}&[15]
        h(t)=\frac{\omega_0^2}{\beta}\e^{-\alpha t}\sinh(\beta t)\varepsilon(t)
    \end{Equation}
    至此，我们求得了过阻尼情形下的冲激响应。

    \paragraph{欠阻尼情形}
    若$\alpha<\omega_0$，此时$\Delta<0$，具有两个共轭的复根，记$\beta=\sqrt{\omega_0^2-\alpha^2}$，则有
    \begin{Equation}&[16]
        \lambda=-\alpha\pm\j\beta
    \end{Equation}
    依据\xref{tab:微分方程不同特征根对应的通解}，此时的通解为
    \begin{Equation}&[17]
        h_0(t)=[C_1\cos\beta t+C_2\sin\beta t]\e^{-\alpha t}
    \end{Equation}
    由$h_0(\zp)=0$容易得到
    \begin{Equation}&[18]
        C_1=0
    \end{Equation}
    此时
    \begin{Equation}&[19]
        \qquad\qquad\qquad
        h_0(t)=C_2\sin\beta t\e^{-\alpha t}\qquad
        h_0'(t)=C_2[\beta\e^{-\alpha t}\cos\beta t-\alpha\e^{-\alpha t}\sin\beta t]
        \qquad\qquad\qquad
    \end{Equation}
    由$h_0'(\zp)=1$容易得到
    \begin{Equation}&[20]
        C_2\beta=1\qquad C_2=\frac{1}{\beta}
    \end{Equation}
    这样一来
    \begin{Equation}&[21]
        h_0(t)=\frac{1}{\beta}\e^{-\alpha t}\sin\beta t
    \end{Equation}
    将\xrefpeq{21}代入\xrefpeq{4}
    \begin{Equation}&[22]
        h(t)=\frac{\omega_0^2}{\beta}\e^{-\alpha t}\sin(\beta t)\varepsilon(t)
    \end{Equation}
    至此，我们求得了欠阻尼情形下的冲激响应。

    \paragraph{临界阻尼情形}
    若$\alpha=\omega_0$，此时$\Delta=0$，具有两个相等的实根，即
    \begin{Equation}&[23]
        \lambda=-\alpha
    \end{Equation}
    依据\xref{tab:微分方程不同特征根对应的通解}，此时的通解为
    \begin{Equation}&[24]
        h_0(t)=[C_1t+C_2]\e^{-\alpha t}
    \end{Equation}
    由$h_0(\zp)$容易得到
    \begin{Equation}&[25]
        C_2=0
    \end{Equation}
    由$h_0(\zm)$容易得到
    \begin{Equation}&[26]
        C_1=1
    \end{Equation}
    这样一来
    \begin{Equation}&[27]
        h_0(t)=t\e^{-\alpha t}
    \end{Equation}
    将\xrefpeq{27}代入\xrefpeq{4}
    \begin{Equation}&[28]
        h(t)=\omega_0^2\e^{-\alpha t}t\varepsilon(t)
    \end{Equation}
    至此，我们就求得了临界阻尼情形下的冲激响应。

    \paragraph{计算阶跃响应}
    根据\fancyref{fml:阶跃响应}，阶跃响应$g(t)$是冲激响应$f(t)$的积分
    \begin{Equation}
        g(t)=\Int[-\infty][t]h(\tau)\dd{\tau}
    \end{Equation}
    代入\xrefpeq{15}, \xrefpeq{22}, \xrefpeq{28}，运用Mathematica软件，得到积分为
    \begin{Align}[6pt]
        g(t)&=\Int[-\infty][t]\frac{\omega_0^2}{\beta}\e^{-\alpha \tau}\sinh(\beta\tau)\varepsilon(t)\dd{\tau}=\frac{\omega_0^2}{\beta}\qty[\frac{\beta-\e^{-\alpha t}[\beta\cosh(\beta t)+\alpha\sinh(\beta t)]}{\alpha^2-\beta^2}]\varepsilon(t)
        && \alpha>\omega_0\\
        g(t)&=\Int[-\infty][t]\frac{\omega_0^2}{\beta}\e^{-\alpha\tau}\sin(\beta\tau)\varepsilon(\tau)\dd{\tau}=\frac{\omega_0^2}{\beta}\qty[\frac{\beta-\e^{-\alpha t}[\beta\cos(\beta t)+\alpha\sin(\beta t)]}{\alpha^2+\beta^2}]\varepsilon(t)
        && \alpha<\omega_0\\
        g(t)&=\Int[-\infty][t]\omega_0^2\e^{-\alpha \tau}\tau\varepsilon(\tau)\dd{\tau}=[1-\e^{-\alpha t}(1+\alpha t)]\varepsilon(t)
        && \alpha=\omega_0
    \end{Align}
    这样就求得了三种情况下的阶跃响应$g(t)$。
\end{Proof}

二阶系统的冲激响应和阶跃响应的如\xref{fig:二阶系统的冲激响应和阶跃响应}所示

\begin{Figure}[二阶系统的冲激响应和阶跃响应]
    \begin{FigureSub}[二阶系统的冲激响应]
        \includegraphics[width=0.48\linewidth]{build/Chapter02B_01a.fig.pdf}
    \end{FigureSub}
    \begin{FigureSub}[二阶系统的阶跃响应]
        \includegraphics[width=0.48\linewidth]{build/Chapter02B_01b.fig.pdf}
    \end{FigureSub}
\end{Figure}

由此可见，临界阻尼$\alpha=\omega_0$是系统响应是否发生振荡的临界点（\xref{fig:二阶系统的冲激响应和阶跃响应}中取$\omega=1$）。